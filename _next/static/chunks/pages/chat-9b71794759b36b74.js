(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[180],{22:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return s(762)}])},762:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return l}});var n=s(5893),a=s(7294),r=s(1163),c=s(3878);function l(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(""),[i,o]=(0,a.useState)(!1),u=(0,a.useRef)(null),h=(0,r.useRouter)();(0,a.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){let t=new e;t.lang="en-IN",t.interimResults=!1,t.maxAlternatives=1,t.onresult=e=>{let t=e.results[0][0].transcript;l(e=>e?e+" "+t:t)},t.onend=()=>o(!1),u.current=t}},[]);let d=()=>{if(u.current)try{u.current.start(),o(!0)}catch(e){console.debug(e)}},x=()=>{if(u.current)try{u.current.stop()}catch(e){}o(!1)},p=async e=>{let n=(null!=e?e:s).trim();if(n){t(e=>[...e,{from:"user",text:n}]),l("");try{let e=await fetch("".concat("http://localhost:8080","/api/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})});if(!e.ok)throw Error("chat failed");let s=await e.json();t(e=>[...e,{from:"bot",text:s.reply}])}catch(e){t(e=>[...e,{from:"bot",text:"Sorry, chat service unavailable."}])}}};return(0,n.jsx)("div",{className:"min-h-screen bg-neutral-50 py-8",children:(0,n.jsxs)("div",{className:"max-w-3xl mx-auto px-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Crop Health Chat"}),(0,n.jsx)("div",{className:"flex gap-2",children:(0,n.jsx)(c.zx,{variant:"ghost",onClick:()=>h.push("/"),children:"Back"})})]}),(0,n.jsx)(c.Zb,{className:"p-4 mb-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm text-neutral-600",children:"Ask about crop health, pests, market prices, or weather. You can type or speak â€” we'll convert voice to text."}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(c.zx,{onClick:()=>i?x():d(),children:i?"Stop":"Speak"}),(0,n.jsx)(c.zx,{onClick:()=>{l("")},children:"Clear"})]})]})}),(0,n.jsx)("div",{className:"space-y-3 mb-6",children:e.map((e,t)=>(0,n.jsx)("div",{className:"user"===e.from?"text-right":"text-left",children:(0,n.jsx)("div",{className:"inline-block px-4 py-2 rounded-lg ".concat("user"===e.from?"bg-primary-600 text-white":"bg-white border"),children:e.text})},t))}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(c.II,{value:s,onChange:e=>l(e.target.value),placeholder:"Type your question"}),(0,n.jsx)(c.zx,{onClick:()=>p(),disabled:!s,children:"Send"})]})]})})}}},function(e){e.O(0,[878,888,774,179],function(){return e(e.s=22)}),_N_E=e.O()}]);