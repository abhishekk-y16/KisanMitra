(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[83],{9547:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nearby-prices",function(){return n(9273)}])},530:function(e,t,n){"use strict";var r=n(5893),a=n(7294),s=n(8370);let l=(0,a.forwardRef)((e,t)=>{let{variant:n="primary",size:a="md",loading:l=!1,icon:o,iconPosition:c="left",fullWidth:d=!1,children:h,className:u="",disabled:m,...x}=e;return(0,r.jsx)("button",{ref:t,className:(0,s.Z)("\n      inline-flex items-center justify-center gap-2 \n      font-semibold rounded-xl\n      transition-all duration-200 ease-out\n      focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2\n      disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\n      active:scale-[0.98]\n    ",{primary:"\n        text-white\n        bg-gradient-to-br from-primary-600 to-primary-700\n        hover:from-primary-500 hover:to-primary-600 hover:shadow-lg hover:-translate-y-0.5\n        focus-visible:ring-primary-500\n        shadow-md\n      ",secondary:"\n        text-neutral-800 bg-white border border-neutral-200\n        hover:bg-neutral-50 hover:border-neutral-300 hover:shadow-md hover:-translate-y-0.5\n        focus-visible:ring-neutral-400\n        shadow-sm\n      ",ghost:"\n        text-neutral-600 bg-transparent\n        hover:bg-neutral-100 hover:text-neutral-800\n        focus-visible:ring-neutral-400\n      ",danger:"\n        text-white\n        bg-gradient-to-br from-red-500 to-red-600\n        hover:from-red-400 hover:to-red-500 hover:shadow-lg hover:-translate-y-0.5\n        focus-visible:ring-red-500\n        shadow-md\n      ",success:"\n        text-white\n        bg-gradient-to-br from-emerald-500 to-emerald-600\n        hover:from-emerald-400 hover:to-emerald-500 hover:shadow-lg hover:-translate-y-0.5\n        focus-visible:ring-emerald-500\n        shadow-md\n      "}[n],{sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-4 text-lg"}[a],d?"w-full":"",u),disabled:m||l,...x,children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i,{size:a}),(0,r.jsx)("span",{children:"Please wait..."})]}):(0,r.jsxs)(r.Fragment,{children:[o&&"left"===c&&(0,r.jsx)("span",{className:"flex-shrink-0",children:o}),h,o&&"right"===c&&(0,r.jsx)("span",{className:"flex-shrink-0",children:o})]})})});function i(e){let{size:t}=e;return(0,r.jsxs)("svg",{className:"animate-spin ".concat({sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"}[t]),fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}l.displayName="Button",t.Z=l},4582:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var r=n(5893),a=n(7294),s=n(8370);let l=(0,a.forwardRef)((e,t)=>{let{variant:n="default",hover:a=!1,selected:l=!1,padding:i="md",children:o,className:c="",...d}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.Z)("\n      rounded-2xl\n      transition-all duration-300 ease-out\n    ",{default:"\n        bg-white border border-neutral-100\n        shadow-[0_4px_8px_rgba(0,0,0,0.08),0_2px_4px_rgba(0,0,0,0.04)]\n      ",elevated:"\n        bg-white border border-neutral-100\n        shadow-[0_8px_24px_rgba(0,0,0,0.12),0_4px_8px_rgba(0,0,0,0.06)]\n      ",outlined:"\n        bg-white border-2 border-neutral-200\n      ",glass:"\n        bg-white/80 backdrop-blur-xl border border-white/50\n        shadow-[0_4px_8px_rgba(0,0,0,0.08)]\n      "}[n],{none:"",sm:"p-4",md:"p-6",lg:"p-8"}[i],a?"cursor-pointer hover:-translate-y-1 hover:shadow-[0_12px_32px_rgba(0,0,0,0.14)] hover:border-primary-200":"",l?"border-primary-500 shadow-[0_4px_8px_rgba(0,0,0,0.08),0_0_0_3px_rgba(76,175,80,0.15)]":"",c),...d,children:o})});function i(e){let{title:t,subtitle:n,action:a,className:s="",...l}=e;return(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4 ".concat(s),...l,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900",children:t}),n&&(0,r.jsx)("p",{className:"text-sm text-neutral-500 mt-0.5",children:n})]}),a&&(0,r.jsx)("div",{className:"flex-shrink-0",children:a})]})}l.displayName="Card",t.Z=l},8370:function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=new Set,a=[];for(let e of t)if(e)for(let t of e.split(/\s+/).filter(Boolean))r.has(t)||(r.add(t),a.push(t));return a.join(" ")}n.d(t,{Z:function(){return r}})},9273:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(5893),a=n(7294),s=n(4582),l=n(530),i=n(1163);function o(){let e=(0,i.useRouter)(),[t,n]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[d,h]=(0,a.useState)("Wheat"),[u,m]=(0,a.useState)("100"),[x,p]=(0,a.useState)(!1),[f,g]=(0,a.useState)([]),[b,v]=(0,a.useState)(null);async function j(e){if(e&&e.preventDefault(),v(null),!t||!o){v("Please provide or allow access to location");return}let n={commodity:d,location:{lat:parseFloat(t),lng:parseFloat(o)},radius_km:parseInt(u||"100",10),top_n:20};try{p(!0);let e=await fetch("".concat("http://127.0.0.1:8000","/api/agmarknet_nearby"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok){let t=await e.text().catch(()=>null);throw Error(t||"Server error")}let t=await e.json();g(t.nearby||[])}catch(e){v(e.message||"Failed to fetch nearby prices")}finally{p(!1)}}return(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 py-8",children:(0,r.jsx)("main",{className:"max-w-3xl mx-auto px-4",children:(0,r.jsxs)(s.Z,{padding:"lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Nearby Mandi Prices"}),(0,r.jsx)("div",{className:"text-sm text-neutral-500",children:"Find mandi prices within X km of your location"})]}),(0,r.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700",children:"Commodity"}),(0,r.jsxs)("select",{value:d,onChange:e=>h(e.target.value),className:"mt-1 w-full",children:[(0,r.jsx)("option",{children:"Wheat"}),(0,r.jsx)("option",{children:"Rice"}),(0,r.jsx)("option",{children:"Maize"}),(0,r.jsx)("option",{children:"Onion"}),(0,r.jsx)("option",{children:"Tomato"}),(0,r.jsx)("option",{children:"Potato"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700",children:"Radius (km)"}),(0,r.jsxs)("select",{value:u,onChange:e=>m(e.target.value),className:"mt-1 w-full",children:[(0,r.jsx)("option",{value:"50",children:"50"}),(0,r.jsx)("option",{value:"100",children:"100"}),(0,r.jsx)("option",{value:"200",children:"200"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700",children:"Latitude"}),(0,r.jsx)("input",{value:t,onChange:e=>n(e.target.value),className:"mt-1 w-full",placeholder:"Allow location or enter lat"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-neutral-700",children:"Longitude"}),(0,r.jsx)("input",{value:o,onChange:e=>c(e.target.value),className:"mt-1 w-full",placeholder:"Allow location or enter lng"})]})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.Z,{type:"button",onClick:function(){if(v(null),!navigator.geolocation){v("Geolocation not supported in this browser");return}navigator.geolocation.getCurrentPosition(e=>{let t=e.coords;n(String(t.latitude)),c(String(t.longitude))},e=>{v(e.message||"Failed to get location")},{enableHighAccuracy:!0,timeout:1e4})},children:"Allow Location"}),(0,r.jsx)(l.Z,{type:"submit",disabled:x,children:x?"Searching…":"Find Nearby Prices"}),(0,r.jsx)(l.Z,{variant:"ghost",onClick:()=>e.push("/"),children:"Back"})]})]}),b&&(0,r.jsx)("div",{className:"mt-4 text-red-600",children:b}),f.length>0&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold",children:["Found ",f.length," mandis within ",u," km"]}),(0,r.jsx)("ul",{className:"mt-3 space-y-2",children:f.map((e,t)=>(0,r.jsxs)("li",{className:"p-3 bg-white rounded shadow-sm flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.city}),(0,r.jsxs)("div",{className:"text-sm text-neutral-600",children:[e.state||""," • ",e.distance_km," km • Price: ₹",e.modal_price]})]}),(0,r.jsx)("div",{className:"flex items-center gap-3",children:(0,r.jsx)("a",{className:"text-primary-600",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps/search/?api=1&query=".concat(encodeURIComponent(e.city+(e.state?", "+e.state:""))),children:"Open in Maps"})})]},t))})]})]})})})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=9547)}),_N_E=e.O()}]);